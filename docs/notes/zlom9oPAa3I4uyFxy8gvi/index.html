<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><title>Mandelbrot</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal knowledge space"/><meta property="og:title" content="Mandelbrot"/><meta property="og:description" content="Personal knowledge space"/><meta property="og:url" content="https://oolonek.github.io/dendron-ws-public/notes/zlom9oPAa3I4uyFxy8gvi/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="12/15/2020"/><meta property="article:modified_time" content="2/8/2021"/><link rel="canonical" href="https://oolonek.github.io/dendron-ws-public/notes/zlom9oPAa3I4uyFxy8gvi/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/dendron-ws-public/_next/static/css/30a05f83f6733b1f.css" as="style"/><link rel="stylesheet" href="/dendron-ws-public/_next/static/css/30a05f83f6733b1f.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/dendron-ws-public/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/dendron-ws-public/_next/static/chunks/webpack-1626b79bda42e25e.js" defer=""></script><script src="/dendron-ws-public/_next/static/chunks/framework-dc33c0b5493501f0.js" defer=""></script><script src="/dendron-ws-public/_next/static/chunks/main-991ccdf7687f671a.js" defer=""></script><script src="/dendron-ws-public/_next/static/chunks/pages/_app-90b9f496cfcf1b3c.js" defer=""></script><script src="/dendron-ws-public/_next/static/chunks/155-0a8d44b6408c244d.js" defer=""></script><script src="/dendron-ws-public/_next/static/chunks/pages/notes/%5Bid%5D-30a63e62504f2dc5.js" defer=""></script><script src="/dendron-ws-public/_next/static/Fif_h8o_yalnGTkyFx1wu/_buildManifest.js" defer=""></script><script src="/dendron-ws-public/_next/static/Fif_h8o_yalnGTkyFx1wu/_ssgManifest.js" defer=""></script><script src="/dendron-ws-public/_next/static/Fif_h8o_yalnGTkyFx1wu/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout site-layout" style="margin-top:64px"><section class="ant-layout site-layout" style="flex-direction:row"><section class="ant-layout site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></section><section class="ant-layout side-layout-main" style="max-width:1200px;display:initial"><main class="ant-layout-content main-content" role="main" style="padding:0 24px"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="mandelbrot"><a aria-hidden="true" class="anchor-heading" href="#mandelbrot"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Mandelbrot</h1>
<h1 id="a-qiime-recipee-for-empress-display-of-the-pf_project"><a aria-hidden="true" class="anchor-heading" href="#a-qiime-recipee-for-empress-display-of-the-pf_project"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>A Qiime recipee for Empress display of the pf_project</h1>
<h2 id="required-inputs"><a aria-hidden="true" class="anchor-heading" href="#required-inputs"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Required inputs</h2>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled> a feature table (mzmine output)</li>
<li class="task-list-item"><input type="checkbox" disabled> a sample metadata table</li>
<li class="task-list-item"><input type="checkbox" disabled> a feature metadata table</li>
</ul>
<p>Beware of the confusion between samples and features. In Qiime features refer to OTU and thus have an assigned taxonomy. I our case we have the taxonomy assigned to the samples.</p>
<h1 id="first-we-deal-with-the-tree-file"><a aria-hidden="true" class="anchor-heading" href="#first-we-deal-with-the-tree-file"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>First we deal with the tree file</h1>
<p>qiime tools import \
--input-path otol_tree_rooted.tre \
--output-path otol_tree_rooted.qza \
--type 'Phylogeny[Rooted]'</p>
<h1 id="the-we-deal-with-the-feature-table"><a aria-hidden="true" class="anchor-heading" href="#the-we-deal-with-the-feature-table"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>the we deal with the feature table</h1>
<h2 id="first-we-use-biom-to-convert-the-tsv-to-the-biom-format"><a aria-hidden="true" class="anchor-heading" href="#first-we-use-biom-to-convert-the-tsv-to-the-biom-format"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>First we use biom to convert the tsv to the biom format</h2>
<p>biom convert \
-i feature_table.tsv \
-o feature_table.biom \
--table-type="OTU table" \
--to-hdf5</p>
<h2 id="conversion-to-qiime-featuretable"><a aria-hidden="true" class="anchor-heading" href="#conversion-to-qiime-featuretable"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Conversion to qiime featureTable</h2>
<p>qiime tools import \
--type 'FeatureTable[Frequency]' \
--input-path feature_table.biom \
--output-path feature_table.qza</p>
<h2 id="we-empress-the-whole-shit"><a aria-hidden="true" class="anchor-heading" href="#we-empress-the-whole-shit"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>We EMPRESS the whole shit</h2>
<p>qiime empress community-plot \
--i-tree otol_tree_rooted.qza \
--i-feature-table feature_table.qza \
--m-sample-metadata-file sample_metadata.tsv \
--m-feature-metadata-file feature_taxa.tsv \
--o-visualization empress-tree.qzv \
--p-filter-missing-features \
--p-ignore-missing-samples</p>
<p>Sadly we get the follwoing message</p>
<p>Plugin error from empress:</p>
<p>  At least one non-root branch of the tree must have a positive length.</p>
<p>We thus try to compute branch lenght in R using the ape package</p>
<h1 id="we-infer-branch-lenght"><a aria-hidden="true" class="anchor-heading" href="#we-infer-branch-lenght"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>we infer branch lenght</h1>
<p>taxa_tree &#x3C;-compute.brlen(taxa_tree)
taxa_tree &#x3C;- read.tree('Dropbox/Research_UNIGE/git_repos/qiime-empress-formatter/src/python/otol_tree.tre')</p>
<h1 id="we-root-the-tree"><a aria-hidden="true" class="anchor-heading" href="#we-root-the-tree"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>we root the tree</h1>
<h1 id="wd_tree_len_rooted---rootwd_tree_len-outgroup--methanobacterium-resolveroot--true"><a aria-hidden="true" class="anchor-heading" href="#wd_tree_len_rooted---rootwd_tree_len-outgroup--methanobacterium-resolveroot--true"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>wd_tree_len_rooted &#x3C;- root(wd_tree_len, outgroup = "Methanobacterium", resolve.root = TRUE)</h1>
<p>is.rooted(taxa_tree)</p>
<p>write.tree(taxa_tree, '~/tmp/empress-tutorial/ecometabo_toyset/ecometabo_taxa_tree_rooted.tree')</p>
<p>write.tree(taxa_tree, 'Dropbox/Research_UNIGE/git_repos/qiime-empress-formatter/src/python/otol_tree_rooted.tre')</p>
<h1 id="lets-add-some-metadata-for-the-feature-table-viz"><a aria-hidden="true" class="anchor-heading" href="#lets-add-some-metadata-for-the-feature-table-viz"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Lets add some metadata for the feature table viz</h1>
<p>qiime feature-table summarize \
--i-table feature_table.qza \
--o-visualization feature_table_viz.qzv \
--m-sample-metadata-file sample_metadata.tsv</p>
<h2 id="metadata-viz"><a aria-hidden="true" class="anchor-heading" href="#metadata-viz"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>metadata viz</h2>
<p>qiime metadata tabulate \
--m-input-file sample_metadata.tsv \
--o-visualization sample_metadata.qzv</p>
<h2 id="lets-try-some-metadat-based-filtering-of-the-feature-table"><a aria-hidden="true" class="anchor-heading" href="#lets-try-some-metadat-based-filtering-of-the-feature-table"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>lets try some metadat based filtering of the feature table</h2>
<p>qiime feature-table filter-samples \
--i-table feature_table.qza \
--m-metadata-file sample_metadata.tsv \
--p-where "[Taxonomical_Score_ISDB]>0" \
--o-filtered-table taxscore-filtered-feature_table.qza</p>
<p>qiime feature-table filter-samples \
--i-table feature-contingency-filtered-table.qza \
--m-metadata-file sample_metadata.tsv \
--p-where "[Consensus_class_ci_cf]!='nan'" \
--o-filtered-table nan-filtered-table.qza</p>
<p>qiime empress community-plot \
--i-tree otol_tree_rooted.qza \
--i-feature-table taxscore-filtered-feature_table.qza \
--m-sample-metadata-file sample_metadata.tsv \
--m-feature-metadata-file feature_taxa.tsv \
--m-feature-metadata-file metadata_otoled.tsv \
--o-visualization empress-tree.qzv \
--p-filter-missing-features \
--p-ignore-missing-samples</p></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#a-qiime-recipee-for-empress-display-of-the-pf_project" title="A Qiime recipee for Empress display of the pf Project">A Qiime recipee for Empress display of the pf Project</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#required-inputs" title="Required inputs">Required inputs</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#first-we-deal-with-the-tree-file" title="First we deal with the tree file">First we deal with the tree file</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#the-we-deal-with-the-feature-table" title="The we deal with the feature table">The we deal with the feature table</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#first-we-use-biom-to-convert-the-tsv-to-the-biom-format" title="First we use biom to convert the tsv to the biom format">First we use biom to convert the tsv to the biom format</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#conversion-to-qiime-featuretable" title="Conversion to qiime featureTable">Conversion to qiime featureTable</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#we-empress-the-whole-shit" title="We EMPRESS the whole shit">We EMPRESS the whole shit</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#we-infer-branch-lenght" title="We infer branch lenght">We infer branch lenght</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#we-root-the-tree" title="We root the tree">We root the tree</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#wd_tree_len_rooted---rootwd_tree_len-outgroup--methanobacterium-resolveroot--true" title="Wd Tree Len Rooted &lt;  root(wd Tree Len, outgroup = &quot;Methanobacterium&quot;, resolve.root = TRUE)">Wd Tree Len Rooted &lt;  root(wd Tree Len, outgroup = &quot;Methanobacterium&quot;, resolve.root = TRUE)</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#lets-add-some-metadata-for-the-feature-table-viz" title="Lets add some metadata for the feature table viz">Lets add some metadata for the feature table viz</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#metadata-viz" title="Metadata viz">Metadata viz</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#lets-try-some-metadat-based-filtering-of-the-feature-table" title="Lets try some metadat based filtering of the feature table">Lets try some metadat based filtering of the feature table</a></div></div></div></div></div></div></div></div></div></main><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></section></section></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"zlom9oPAa3I4uyFxy8gvi","title":"Mandelbrot","desc":"","updated":1612800007709,"created":1608048463386,"custom":{},"fname":"tools.chemoinformatics.qiime.empress.mandelbrot","type":"note","vault":{"fsPath":"vault"},"contentHash":"861ffd70ce1adb8d1cf7c994a7178481","links":[],"anchors":{"a-qiime-recipee-for-empress-display-of-the-pf_project":{"type":"header","text":"A Qiime recipee for Empress display of the pf_project","value":"a-qiime-recipee-for-empress-display-of-the-pf_project","line":8,"column":0,"depth":1},"required-inputs":{"type":"header","text":"Required inputs","value":"required-inputs","line":10,"column":0,"depth":2},"first-we-deal-with-the-tree-file":{"type":"header","text":"First we deal with the tree file","value":"first-we-deal-with-the-tree-file","line":21,"column":0,"depth":1},"the-we-deal-with-the-feature-table":{"type":"header","text":"the we deal with the feature table","value":"the-we-deal-with-the-feature-table","line":28,"column":0,"depth":1},"first-we-use-biom-to-convert-the-tsv-to-the-biom-format":{"type":"header","text":"First we use biom to convert the tsv to the biom format","value":"first-we-use-biom-to-convert-the-tsv-to-the-biom-format","line":30,"column":0,"depth":2},"conversion-to-qiime-featuretable":{"type":"header","text":"Conversion to qiime featureTable","value":"conversion-to-qiime-featuretable","line":37,"column":0,"depth":2},"we-empress-the-whole-shit":{"type":"header","text":"We EMPRESS the whole shit","value":"we-empress-the-whole-shit","line":44,"column":0,"depth":2},"we-infer-branch-lenght":{"type":"header","text":"we infer branch lenght","value":"we-infer-branch-lenght","line":65,"column":0,"depth":1},"we-root-the-tree":{"type":"header","text":"we root the tree","value":"we-root-the-tree","line":70,"column":0,"depth":1},"wd_tree_len_rooted---rootwd_tree_len-outgroup--methanobacterium-resolveroot--true":{"type":"header","text":"wd_tree_len_rooted \u003c- root(wd_tree_len, outgroup = \"Methanobacterium\", resolve.root = TRUE)","value":"wd_tree_len_rooted---rootwd_tree_len-outgroup--methanobacterium-resolveroot--true","line":72,"column":0,"depth":1},"lets-add-some-metadata-for-the-feature-table-viz":{"type":"header","text":"Lets add some metadata for the feature table viz","value":"lets-add-some-metadata-for-the-feature-table-viz","line":82,"column":0,"depth":1},"metadata-viz":{"type":"header","text":"metadata viz","value":"metadata-viz","line":89,"column":0,"depth":2},"lets-try-some-metadat-based-filtering-of-the-feature-table":{"type":"header","text":"lets try some metadat based filtering of the feature table","value":"lets-try-some-metadat-based-filtering-of-the-feature-table","line":95,"column":0,"depth":2}},"children":[],"parent":"FNTnyMdvggc3hlu0FbWoR","data":{}},"body":"\u003ch1 id=\"mandelbrot\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#mandelbrot\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eMandelbrot\u003c/h1\u003e\n\u003ch1 id=\"a-qiime-recipee-for-empress-display-of-the-pf_project\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#a-qiime-recipee-for-empress-display-of-the-pf_project\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eA Qiime recipee for Empress display of the pf_project\u003c/h1\u003e\n\u003ch2 id=\"required-inputs\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#required-inputs\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eRequired inputs\u003c/h2\u003e\n\u003cul class=\"contains-task-list\"\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" disabled\u003e a feature table (mzmine output)\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" disabled\u003e a sample metadata table\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" disabled\u003e a feature metadata table\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eBeware of the confusion between samples and features. In Qiime features refer to OTU and thus have an assigned taxonomy. I our case we have the taxonomy assigned to the samples.\u003c/p\u003e\n\u003ch1 id=\"first-we-deal-with-the-tree-file\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#first-we-deal-with-the-tree-file\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eFirst we deal with the tree file\u003c/h1\u003e\n\u003cp\u003eqiime tools import \\\n--input-path otol_tree_rooted.tre \\\n--output-path otol_tree_rooted.qza \\\n--type 'Phylogeny[Rooted]'\u003c/p\u003e\n\u003ch1 id=\"the-we-deal-with-the-feature-table\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#the-we-deal-with-the-feature-table\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003ethe we deal with the feature table\u003c/h1\u003e\n\u003ch2 id=\"first-we-use-biom-to-convert-the-tsv-to-the-biom-format\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#first-we-use-biom-to-convert-the-tsv-to-the-biom-format\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eFirst we use biom to convert the tsv to the biom format\u003c/h2\u003e\n\u003cp\u003ebiom convert \\\n-i feature_table.tsv \\\n-o feature_table.biom \\\n--table-type=\"OTU table\" \\\n--to-hdf5\u003c/p\u003e\n\u003ch2 id=\"conversion-to-qiime-featuretable\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#conversion-to-qiime-featuretable\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eConversion to qiime featureTable\u003c/h2\u003e\n\u003cp\u003eqiime tools import \\\n--type 'FeatureTable[Frequency]' \\\n--input-path feature_table.biom \\\n--output-path feature_table.qza\u003c/p\u003e\n\u003ch2 id=\"we-empress-the-whole-shit\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#we-empress-the-whole-shit\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eWe EMPRESS the whole shit\u003c/h2\u003e\n\u003cp\u003eqiime empress community-plot \\\n--i-tree otol_tree_rooted.qza \\\n--i-feature-table feature_table.qza \\\n--m-sample-metadata-file sample_metadata.tsv \\\n--m-feature-metadata-file feature_taxa.tsv \\\n--o-visualization empress-tree.qzv \\\n--p-filter-missing-features \\\n--p-ignore-missing-samples\u003c/p\u003e\n\u003cp\u003eSadly we get the follwoing message\u003c/p\u003e\n\u003cp\u003ePlugin error from empress:\u003c/p\u003e\n\u003cp\u003e  At least one non-root branch of the tree must have a positive length.\u003c/p\u003e\n\u003cp\u003eWe thus try to compute branch lenght in R using the ape package\u003c/p\u003e\n\u003ch1 id=\"we-infer-branch-lenght\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#we-infer-branch-lenght\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003ewe infer branch lenght\u003c/h1\u003e\n\u003cp\u003etaxa_tree \u0026#x3C;-compute.brlen(taxa_tree)\ntaxa_tree \u0026#x3C;- read.tree('Dropbox/Research_UNIGE/git_repos/qiime-empress-formatter/src/python/otol_tree.tre')\u003c/p\u003e\n\u003ch1 id=\"we-root-the-tree\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#we-root-the-tree\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003ewe root the tree\u003c/h1\u003e\n\u003ch1 id=\"wd_tree_len_rooted---rootwd_tree_len-outgroup--methanobacterium-resolveroot--true\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#wd_tree_len_rooted---rootwd_tree_len-outgroup--methanobacterium-resolveroot--true\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003ewd_tree_len_rooted \u0026#x3C;- root(wd_tree_len, outgroup = \"Methanobacterium\", resolve.root = TRUE)\u003c/h1\u003e\n\u003cp\u003eis.rooted(taxa_tree)\u003c/p\u003e\n\u003cp\u003ewrite.tree(taxa_tree, '~/tmp/empress-tutorial/ecometabo_toyset/ecometabo_taxa_tree_rooted.tree')\u003c/p\u003e\n\u003cp\u003ewrite.tree(taxa_tree, 'Dropbox/Research_UNIGE/git_repos/qiime-empress-formatter/src/python/otol_tree_rooted.tre')\u003c/p\u003e\n\u003ch1 id=\"lets-add-some-metadata-for-the-feature-table-viz\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#lets-add-some-metadata-for-the-feature-table-viz\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eLets add some metadata for the feature table viz\u003c/h1\u003e\n\u003cp\u003eqiime feature-table summarize \\\n--i-table feature_table.qza \\\n--o-visualization feature_table_viz.qzv \\\n--m-sample-metadata-file sample_metadata.tsv\u003c/p\u003e\n\u003ch2 id=\"metadata-viz\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#metadata-viz\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003emetadata viz\u003c/h2\u003e\n\u003cp\u003eqiime metadata tabulate \\\n--m-input-file sample_metadata.tsv \\\n--o-visualization sample_metadata.qzv\u003c/p\u003e\n\u003ch2 id=\"lets-try-some-metadat-based-filtering-of-the-feature-table\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#lets-try-some-metadat-based-filtering-of-the-feature-table\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003elets try some metadat based filtering of the feature table\u003c/h2\u003e\n\u003cp\u003eqiime feature-table filter-samples \\\n--i-table feature_table.qza \\\n--m-metadata-file sample_metadata.tsv \\\n--p-where \"[Taxonomical_Score_ISDB]\u003e0\" \\\n--o-filtered-table taxscore-filtered-feature_table.qza\u003c/p\u003e\n\u003cp\u003eqiime feature-table filter-samples \\\n--i-table feature-contingency-filtered-table.qza \\\n--m-metadata-file sample_metadata.tsv \\\n--p-where \"[Consensus_class_ci_cf]!='nan'\" \\\n--o-filtered-table nan-filtered-table.qza\u003c/p\u003e\n\u003cp\u003eqiime empress community-plot \\\n--i-tree otol_tree_rooted.qza \\\n--i-feature-table taxscore-filtered-feature_table.qza \\\n--m-sample-metadata-file sample_metadata.tsv \\\n--m-feature-metadata-file feature_taxa.tsv \\\n--m-feature-metadata-file metadata_otoled.tsv \\\n--o-visualization empress-tree.qzv \\\n--p-filter-missing-features \\\n--p-ignore-missing-samples\u003c/p\u003e","noteIndex":{"id":"gvOH1py1NfW3ihejtp1nt","title":"Root","desc":"","updated":1629628449617,"created":1629628449617,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"35415410233b3af68001893c83fd0c46","links":[{"type":"wiki","from":{"fname":"root","id":"gvOH1py1NfW3ihejtp1nt","vaultName":"vault"},"value":"user.oolonek","alias":"@oolonek","position":{"start":{"line":5,"column":7,"offset":225},"end":{"line":5,"column":15,"offset":233},"indent":[]},"xvault":false,"to":{"fname":"user.oolonek"}}],"anchors":{"welcome-to-dendron":{"type":"header","text":"Welcome to Dendron","value":"welcome-to-dendron","line":7,"column":0,"depth":1}},"children":["kPtYPP8JzWBTzWz6JpnkS","3LmAI71UuDJHeWZiY9h96","TyTThFOL2RNC8FAIj5bZN","e4C8xkTTKKue3fz5ywgBH","rInb8zzM4kEHelz4CeWDa","hUOQrqfgNFdSu7GD8fP2c","J9JmfJgjDT8Oz6WilFnKw","Iu50F9KOgYp0CDpwKBlx6","xZShWyRUMIXQaN30pKmCM","f1fsD9inrKMVapeKNhEhT","VhvHTRFNvIEee7odQvekB","D2j8S1AufMK6GbZTZ9BJz","HMvEFZAnQOxD77TnbVwGV","NYpAWkhSLKKkHIbDIbshA","0MSZusMXhweDvHD3Iggww","q5kFqQrTnytdWSux3nwOk","1PGMuBcw56lKG0Xu5sxIX","f4P2xBJLTHpQpJYiJh7BV","7KJGsaBJWOOHaHqElRaJq","BunyVngKi3As0C0CO5xhy","iRR8MxJPGIvfKl5pcOirA","3qcjidzC0tkyobYKlrWYc","uviazqrM9NUAMm9dWYVa7","53WWGL5wGfRDGtBEJoqBd","EoQW6Rm5LYkkCxMgDVXHd","k7IyxWpd9nYqWlhZ96CAG","maJAMIUSNCqgSTXrQ7fu5","59ftsVxFXXM9bB43vfKwK","rrfMr3vOgkyJv21N8x99X","7WpN3kiuBsunRJ17P3mGr","u88hb42Nk8jvzQwtMfM3z"],"parent":null,"data":{},"body":"# Welcome to Dendron\n\nThis is the root of your dendron vault. If you decide to publish your entire vault, this will be your landing page. You are free to customize any part of this page except the frontmatter on top. \n\nKudos @oolonek, you did great job! \nWhen using https://oolonek.github.io/dendron-ws-private/, here is what I got:\n\n\u003cimg width=\"1676\" alt=\"Capture d’écran 2021-08-22 à 13 19 54\" src=\"https://user-images.githubusercontent.com/44283913/130353241-43ba98eb-d947-473c-be08-d924f0ef585b.png\"\u003e\n\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":4,"useFMTitle":true,"useNoteTitleForLink":true,"mermaid":true,"useKatex":true,"dev":{"enablePreviewV2":true},"site":{"copyAssets":true,"siteHierarchies":["root"],"siteRootDir":"docs","siteUrl":"https://oolonek.github.io","gh_edit_link":true,"gh_edit_link_text":"Click here to edit this page on Github !","gh_edit_repository":"https://github.com/oolonek/dendron-ws-public","gh_edit_branch":"main","gh_edit_view_mode":"edit","assetsPrefix":"/dendron-ws-public","usePrettyRefs":true,"siteLastModified":true,"title":"GrndStt's Dendron","description":"Personal knowledge space","duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"usePrettyLinks":true,"siteNotesDir":"notes","siteFaviconPath":"favicon.ico","gh_root":"docs/","writeStubs":true,"siteIndex":"root"},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2,"vaultSelectionModeOnCreate":"smart"}},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"randomNote":{}},"workspace":{"dendronVersion":"0.77.1","vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"graph":{"zoomSpeed":1},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":true,"maxPreviewsCached":10,"maxNoteLength":204800,"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"enableUserTags":true,"enableHashTags":true,"enableEditorDecorations":true},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"zlom9oPAa3I4uyFxy8gvi"},"buildId":"Fif_h8o_yalnGTkyFx1wu","assetPrefix":"/dendron-ws-public","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>